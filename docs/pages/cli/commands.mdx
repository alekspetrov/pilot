# CLI Commands

## pilot start

Start Pilot in polling mode.

```bash
pilot start [flags]
```

### Flags

| Flag | Description |
|------|-------------|
| `--telegram` | Enable Telegram polling (overrides config) |
| `--github` | Enable GitHub polling (overrides config) |
| `--linear` | Enable Linear webhooks (overrides config) |
| `--slack` | Enable Slack Socket Mode (overrides config) |
| `--autopilot=ENV` | Enable autopilot: `dev`, `stage`, `prod` |
| `--auto-release` | Enable tag-based release automation (requires autopilot=prod) |
| `--dashboard` | Show TUI dashboard for real-time task monitoring |
| `-d`, `--daemon` | Run in background (daemon mode) |
| `-p`, `--project` | Project path (default: config default or cwd) |
| `--replace` | Kill existing bot instance before starting |
| `--no-gateway` | Run polling adapters only (no HTTP gateway) |
| `--sequential` | Sequential execution: wait for PR merge before next issue |
| `--tunnel` | Enable public tunnel for webhook ingress (Cloudflare/ngrok) |
| `--team` | Team ID or name for project access scoping |
| `--team-member` | Member email for team access scoping |
| `--log-format` | Log output format: `text` or `json` (default: text) |

### Examples

```bash
# Basic: Telegram + GitHub
pilot start --telegram --github

# With autopilot (auto-merge after CI)
pilot start --telegram --github --autopilot=stage

# With dashboard
pilot start --telegram --github --dashboard

# Sequential execution (wait for merge before next)
pilot start --github --sequential

# Production with auto-release
pilot start --github --autopilot=prod --auto-release

# Run in background
pilot start --telegram --github -d

# With JSON logging for aggregation systems
pilot start --github --log-format=json
```

## pilot task

Execute a single task.

```bash
pilot task "description" [flags]
```

### Flags

| Flag | Description |
|------|-------------|
| `-p`, `--project` | Project path (default: current directory) |
| `--dry-run` | Show what would be executed without running |
| `-v`, `--verbose` | Stream Claude Code output |
| `--alerts` | Enable alerts for task execution |
| `--budget` | Enable budget enforcement for this task |
| `--team` | Team ID or name for project access scoping |
| `--team-member` | Member email for team access scoping |

### Examples

```bash
# Quick local execution
pilot task "Fix the typo in README.md"

# Preview what will happen
pilot task "Refactor auth module" --dry-run

# With verbose output
pilot task "Add rate limiting" --verbose

# With budget enforcement
pilot task "Implement caching" --budget

# Scoped to specific team
pilot task "Update API docs" --team=backend
```

## pilot upgrade

Self-update to latest version.

```bash
pilot upgrade [subcommand]
```

### Subcommands

| Subcommand | Description |
|------------|-------------|
| `check` | Check for available updates |
| `run` | Download and install the latest version (default) |
| `rollback` | Restore the previous version from backup |

### pilot upgrade check

Check for updates without installing.

```bash
pilot upgrade check [flags]
```

| Flag | Description |
|------|-------------|
| `--json` | Output as JSON |

### pilot upgrade run

Download and install the latest version.

```bash
pilot upgrade run [flags]
```

| Flag | Description |
|------|-------------|
| `-f`, `--force` | Skip waiting for running tasks |
| `-y`, `--yes` | Skip confirmation prompt |

### pilot upgrade rollback

Restore the previous Pilot version from backup created during upgrade.

```bash
pilot upgrade rollback
```

### Examples

```bash
# Check for updates only
pilot upgrade check

# Upgrade (with confirmation)
pilot upgrade

# Upgrade without confirmation
pilot upgrade run --yes

# Force upgrade, skip task wait
pilot upgrade run --force

# Restore previous version
pilot upgrade rollback
```

## pilot init

Initialize Pilot configuration.

```bash
pilot init [flags]
```

Creates `~/.pilot/config.yaml` with interactive prompts.

### Flags

| Flag | Description |
|------|-------------|
| `--force` | Reinitialize config (backs up existing to .bak) |

## pilot doctor

Check system health and configuration.

```bash
pilot doctor [flags]
```

Shows what's working, what's missing, and how to fix issues.

### Flags

| Flag | Description |
|------|-------------|
| `-v`, `--verbose` | Show detailed output with fix suggestions |

### Examples

```bash
# Run all checks
pilot doctor

# Show detailed output
pilot doctor --verbose
```

## pilot logs

View task execution logs.

```bash
pilot logs [task-id] [flags]
```

Without arguments, shows recent task logs. With a task ID, shows detailed logs for that specific task.

### Flags

| Flag | Description |
|------|-------------|
| `-n`, `--limit` | Number of recent tasks to show (default: 10) |
| `-f`, `--follow` | Follow log output (not yet implemented) |
| `-v`, `--verbose` | Show detailed output |
| `--json` | Output as JSON |

### Examples

```bash
# Show recent task logs
pilot logs

# Show last 20 tasks
pilot logs --limit 20

# Show logs for specific task
pilot logs TASK-12345

# Show logs for GitHub issue task
pilot logs GH-15

# JSON output
pilot logs --json
```

---

## Daemon Control

### pilot stop

Stop the Pilot daemon.

```bash
pilot stop
```

Signals the running Pilot daemon to shut down gracefully. For daemons started with `pilot start -d`, this command provides guidance on stopping the process.

#### Usage Notes

- Use `Ctrl+C` to stop a foreground Pilot process
- Use `SIGTERM` to stop a background daemon: `kill $(pgrep pilot)`
- For systemd/launchd managed services, use the appropriate service manager commands

#### Examples

```bash
# Stop daemon (shows guidance)
pilot stop

# Alternative: stop via signal
kill -TERM $(pgrep -f "pilot start")

# Alternative: stop via pkill
pkill -f "pilot start"
```

### pilot status

Show Pilot status and running configuration.

```bash
pilot status [flags]
```

Displays current configuration state including gateway address, enabled adapters, and configured projects.

#### Flags

| Flag | Description |
|------|-------------|
| `--json` | Output as JSON for programmatic access |

#### Output

The command displays:
- **Gateway**: HTTP endpoint address (host:port)
- **Adapters**: Status of each adapter (Linear, Slack, Telegram, GitHub)
- **Projects**: Configured project paths with Navigator detection

#### Examples

```bash
# Show human-readable status
pilot status

# Output as JSON (for scripts)
pilot status --json

# Parse JSON with jq
pilot status --json | jq '.adapters'
```

#### Sample Output

```
ðŸ“Š Pilot Status
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Gateway: http://localhost:8080

Adapters:
  âœ“ Telegram (enabled)
  â—‹ Linear (disabled)
  â—‹ Slack (disabled)
  âœ“ GitHub (enabled)

Projects:
  â€¢ pilot: /Users/dev/pilot [Navigator]
  â€¢ webapp: /Users/dev/webapp
```

---

## Setup & Configuration

### pilot setup

Interactive setup wizard for Pilot configuration.

```bash
pilot setup [flags]
```

Guides you through configuring Pilot step by step, including Telegram bot, projects, voice transcription, daily briefs, and alerts.

#### Flags

| Flag | Description |
|------|-------------|
| `--skip-optional` | Skip optional features (voice, briefs, alerts) |
| `--tunnel` | Set up Cloudflare Tunnel for webhooks |
| `--no-sleep` | Disable Mac sleep for always-on operation (macOS only, requires sudo) |

#### Setup Steps

1. **Telegram Bot** - Configure bot token and chat ID
2. **Projects** - Add project paths with automatic Navigator detection
3. **Voice Transcription** (optional) - Configure OpenAI Whisper API
4. **Daily Briefs** (optional) - Set up scheduled status reports
5. **Alerts** (optional) - Enable failure notifications

#### Examples

```bash
# Full interactive setup
pilot setup

# Quick setup (skip optional features)
pilot setup --skip-optional

# Set up Cloudflare Tunnel for webhooks
pilot setup --tunnel

# Disable Mac sleep for always-on server
pilot setup --no-sleep
```

### pilot config

Manage Pilot configuration.

```bash
pilot config <subcommand>
```

View, edit, and validate the Pilot configuration file.

#### Subcommands

| Subcommand | Description |
|------------|-------------|
| `show` | Display current configuration |
| `edit` | Open config in editor |
| `validate` | Validate configuration syntax |
| `path` | Show config file path |

### pilot config show

Display current configuration.

```bash
pilot config show [flags]
```

Outputs the full configuration in YAML or JSON format.

#### Flags

| Flag | Description |
|------|-------------|
| `--json` | Output as JSON instead of YAML |

#### Examples

```bash
# Show config as YAML
pilot config show

# Show config as JSON
pilot config show --json

# Pipe to tools
pilot config show --json | jq '.projects'
```

### pilot config edit

Open configuration in your default editor.

```bash
pilot config edit
```

Opens `~/.pilot/config.yaml` in your editor. Uses `$EDITOR` environment variable, falling back to vim, nano, or vi.

After editing, the configuration is automatically validated.

#### Editor Selection

1. `$EDITOR` environment variable
2. `$VISUAL` environment variable
3. vim (if available)
4. nano (if available)
5. vi (if available)

#### Examples

```bash
# Open in default editor
pilot config edit

# Use specific editor
EDITOR=code pilot config edit
EDITOR=nano pilot config edit
```

### pilot config validate

Validate configuration syntax and structure.

```bash
pilot config validate [flags]
```

Checks YAML syntax and validates configuration structure. Reports warnings for common issues like missing tokens or non-existent project paths.

#### Flags

| Flag | Description |
|------|-------------|
| `-q`, `--quiet` | Exit with code 1 on error, no output |

#### Validation Checks

- YAML syntax validity
- Configuration structure
- Enabled adapters have required tokens
- Project paths exist on filesystem

#### Examples

```bash
# Validate with full output
pilot config validate

# Silent validation for scripts
if pilot config validate --quiet; then
  echo "Config OK"
else
  echo "Config invalid"
fi
```

#### Sample Output

```
Config: ~/.pilot/config.yaml

Syntax:     OK
Validation: OK

Warnings:
  - GitHub enabled but token not set
  - Project path does not exist: /old/project
```

### pilot config path

Show the configuration file path.

```bash
pilot config path
```

Outputs the absolute path to the configuration file. Useful for scripts and automation.

#### Examples

```bash
# Show path
pilot config path
# Output: /Users/dev/.pilot/config.yaml

# Use in scripts
cat "$(pilot config path)"

# Back up config
cp "$(pilot config path)" config-backup.yaml
```

### pilot completion

Generate shell completion scripts.

```bash
pilot completion <shell>
```

Generates autocompletion scripts for bash, zsh, fish, or PowerShell.

#### Supported Shells

| Shell | Description |
|-------|-------------|
| `bash` | Bash completion script |
| `zsh` | Zsh completion script |
| `fish` | Fish completion script |
| `powershell` | PowerShell completion script |

#### Installation

**Bash:**
```bash
# Load for current session
source <(pilot completion bash)

# Install permanently (Linux)
pilot completion bash > /etc/bash_completion.d/pilot

# Install permanently (macOS with Homebrew)
pilot completion bash > $(brew --prefix)/etc/bash_completion.d/pilot
```

**Zsh:**
```bash
# Enable completion (if not already enabled)
echo "autoload -U compinit; compinit" >> ~/.zshrc

# Install completion
pilot completion zsh > "${fpath[1]}/_pilot"

# Start new shell for changes to take effect
```

**Fish:**
```bash
# Load for current session
pilot completion fish | source

# Install permanently
pilot completion fish > ~/.config/fish/completions/pilot.fish
```

**PowerShell:**
```powershell
# Load for current session
pilot completion powershell | Out-String | Invoke-Expression

# Install permanently (add to profile)
pilot completion powershell > pilot.ps1
# Then source from PowerShell profile
```

---

## Information

### pilot version

Show Pilot version information.

```bash
pilot version
```

Displays the current Pilot version and build time.

#### Examples

```bash
pilot version
# Output:
# Pilot v0.63.0
# Built: 2024-01-15T10:30:00Z
```

---

## Execution & Review

Commands for executing tasks and reviewing work history.

### pilot github run

Execute a GitHub issue as a Pilot task.

```bash
pilot github run <issue-number> [flags]
```

Fetches a GitHub issue and executes it as a Pilot task. PRs are always created to enable autopilot workflow.

#### Flags

| Flag | Description |
|------|-------------|
| `-p`, `--project` | Project path |
| `--repo` | GitHub repository (owner/repo) |
| `--dry-run` | Show what would execute without running |
| `-v`, `--verbose` | Verbose output |
| `--team` | Team ID or name for project access scoping |
| `--team-member` | Member email for team access scoping |

#### Examples

```bash
# Execute issue #8
pilot github run 8

# Execute from specific repository
pilot github run 8 --repo owner/repo

# Preview execution
pilot github run 8 --dry-run

# With verbose output
pilot github run 8 --verbose
```

### pilot brief

Generate and send daily/weekly briefs.

```bash
pilot brief [flags]
```

Generate and optionally send daily/weekly briefs summarizing Pilot activity.

#### Flags

| Flag | Description |
|------|-------------|
| `--now` | Generate and send brief immediately |
| `--weekly` | Generate a weekly summary |

#### Examples

```bash
# Show scheduler status
pilot brief

# Generate and send brief immediately
pilot brief --now

# Generate a weekly summary
pilot brief --weekly
```

### pilot replay

Replay and debug execution recordings.

```bash
pilot replay <subcommand>
```

View, replay, and analyze execution recordings for debugging and improvement.

#### Subcommands

| Subcommand | Description |
|------------|-------------|
| `list` | List available recordings |
| `show` | Show recording details |
| `play` | Replay execution with interactive viewer |
| `analyze` | Generate detailed analysis |
| `export` | Export recording to HTML/JSON/Markdown |
| `delete` | Delete a recording |

### pilot replay list

List available execution recordings.

```bash
pilot replay list [flags]
```

Display recordings with filtering options.

#### Flags

| Flag | Description |
|------|-------------|
| `--limit` | Maximum number of recordings to show (default: 20) |
| `--project` | Filter by project name |
| `--status` | Filter by status (success, error, timeout) |

#### Examples

```bash
# List recent recordings
pilot replay list

# Show only last 10
pilot replay list --limit 10

# Filter by project
pilot replay list --project pilot

# Show only failed executions
pilot replay list --status error
```

### pilot replay show

Show detailed information about a recording.

```bash
pilot replay show <recording-id>
```

Display metadata, events summary, and performance metrics for a specific recording.

#### Examples

```bash
# Show recording details
pilot replay show TG-1234567890

# Example output includes:
# - Basic info (task ID, duration, token usage)
# - Phase breakdown
# - Tool usage statistics
# - Error summary (if any)
```

### pilot replay play

Replay execution with interactive viewer.

```bash
pilot replay play <recording-id> [flags]
```

Interactive playback of the execution with step-by-step navigation.

#### Flags

| Flag | Description |
|------|-------------|
| `--start` | Start from event sequence number |
| `--stop` | Stop at event sequence number (0 = end) |
| `-v`, `--verbose` | Show all event details |
| `--tui` | Use interactive TUI viewer (default: true) |
| `--speed` | Playback speed (0 = instant, 1 = real-time, 2 = 2x) |

#### Examples

```bash
# Interactive replay
pilot replay play TG-1234567890

# Start from event 50
pilot replay play TG-1234567890 --start 50

# Simple output mode (no TUI)
pilot replay play TG-1234567890 --no-tui

# Show verbose details
pilot replay play TG-1234567890 --verbose
```

### pilot replay analyze

Generate detailed analysis of execution recording.

```bash
pilot replay analyze <recording-id>
```

Provides analysis of token usage, phase timing, tool usage patterns, and error diagnostics.

#### Examples

```bash
# Analyze execution
pilot replay analyze TG-1234567890

# Output includes:
# - Token usage breakdown by phase
# - Tool usage patterns
# - Performance bottlenecks
# - Error analysis and recommendations
```

### pilot replay export

Export recording to various formats.

```bash
pilot replay export <recording-id> [flags]
```

Export execution recording for sharing or external analysis.

#### Flags

| Flag | Description |
|------|-------------|
| `--format` | Output format: html, json, markdown (default: html) |
| `--output` | Output file path (default: auto-generated) |
| `--with-analysis` | Include detailed analysis in export |

#### Examples

```bash
# Export as HTML
pilot replay export TG-1234567890

# Export with analysis
pilot replay export TG-1234567890 --with-analysis

# Export as JSON
pilot replay export TG-1234567890 --format json

# Export as Markdown
pilot replay export TG-1234567890 --format markdown

# Custom output file
pilot replay export TG-1234567890 --output report.html
```

### pilot replay delete

Delete an execution recording.

```bash
pilot replay delete <recording-id> [flags]
```

Remove a recording from the database to free up storage space.

#### Flags

| Flag | Description |
|------|-------------|
| `--force` | Skip confirmation prompt |

#### Examples

```bash
# Delete with confirmation
pilot replay delete TG-1234567890

# Force delete without confirmation
pilot replay delete TG-1234567890 --force
```

### pilot patterns

Manage cross-project patterns.

```bash
pilot patterns <subcommand>
```

View, search, and manage learned patterns across projects.

#### Subcommands

| Subcommand | Description |
|------------|-------------|
| `list` | List discovered patterns |
| `search` | Search patterns by keyword |
| `stats` | Show pattern statistics |

### pilot patterns list

List discovered patterns from execution history.

```bash
pilot patterns list [flags]
```

Display patterns learned from successful and failed executions.

#### Flags

| Flag | Description |
|------|-------------|
| `--limit` | Maximum number of patterns to show (default: 50) |
| `--min-confidence` | Minimum confidence score (0.0-1.0, default: 0.5) |
| `--type` | Pattern type filter (success, error, tool-usage) |
| `--show-anti` | Include anti-patterns (things to avoid) |

#### Examples

```bash
# List top patterns
pilot patterns list

# Show high-confidence patterns only
pilot patterns list --min-confidence 0.8

# Show anti-patterns
pilot patterns list --show-anti

# Limit results
pilot patterns list --limit 20
```

### pilot patterns search

Search patterns by keyword or description.

```bash
pilot patterns search <query>
```

Find patterns matching specific keywords or problem descriptions.

#### Examples

```bash
# Search for authentication patterns
pilot patterns search "authentication"

# Search for error handling patterns
pilot patterns search "error handling"

# Search for specific technologies
pilot patterns search "React hooks"
```

### pilot patterns stats

Display pattern discovery statistics.

```bash
pilot patterns stats
```

Show overview of pattern discovery across projects including:
- Total patterns discovered
- Confidence distribution
- Most common pattern types
- Project coverage

#### Examples

```bash
# Show pattern statistics
pilot patterns stats

# Example output:
# Total patterns: 247
# High confidence (>0.8): 89 patterns
# Success patterns: 198
# Anti-patterns: 49
# Projects covered: 12
```
